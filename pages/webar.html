<!DOCTYPE html>
<html>
	<head>
		<title>Scan your card!</title>

		<!-- Loading the AR.js library based on the documentation from @jerome_etienne -->
		<script src = "https://aframe.io/releases/0.8.0/aframe.min.js"></script>
		<script src = "https://cdn.rawgit.com/jeromeetienne/AR.js/1.6.2/aframe/build/aframe-ar.js"></script>
	</head>

	<!-- This registers a-markers WITH the tag 'registerevents' to emit events such as markerFound and markerLost-->
	<script>
		AFRAME.registerComponent('registerevents',
		{
			init: function()
			{
				// Getting the marker reference
				var marker = this.el;
				// Making sure that the marker emits the wanted events.
				marker.setAttribute('emitevents', 'true');

				// Registering a new function to the markerFound Event
				marker.addEventListener('markerFound', function()
				{
					// We grab the id of the marker as it will contain information about what
					// card we have scanned.
					var markerID = marker.id;

					// Opening a webpage in the same window/tab. This will be changed to include 
					// a variable instructing the model viewer to open a specific model.
					var pageName = 'modelv-viewer.html';
					var parameterPrefix = '?id=';

					var url = pageName + parameterPrefix + markerID;

					window.open(url, '_self');
				});
			}
		});

	</script>

	<body>
		<a-scene embedded arjs='sourceType: webcam; trackingMethod: best; debugUIEnabled: false;'>

				<!-- Tracking the default Hiro Pattern and showing a Cube
					 This marker is set up to emit events using the registerevents attribute -->
				<a-marker id='0' type="pattern" url="https://jamieonepolygon.github.io/Patterns/marker02_patt.patt" registerevents>
					<a-box position='0 0.5 0' color='red'></a-box>
				</a-marker>

				<a-marker id='1' preset=kanji' registerevents>
					<a-box position= '0 0.5 0' color='blue'></a-box>
				</a-marker>

			<!-- Adding a Simple Camera to the scene -->
			<a-entity camera></a-entity>
		</a-scene>		

	</body>

</html>